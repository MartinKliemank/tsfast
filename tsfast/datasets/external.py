# AUTOGENERATED! DO NOT EDIT! File to edit: ../../nbs/01_datasets/01_external.ipynb.

# %% auto 0
__all__ = ['u', 'y', 'download_function', 'create_dls_wh', 'create_dls_wh_prediction', 'create_dls_silverbox',
           'create_dls_silverbox_prediction', 'create_dls_cascaded_tanks', 'create_dls_cascaded_tanks_prediction',
           'create_dls_emps', 'create_dls_emps_prediction', 'create_dls_noisy_wh', 'create_dls_noisy_wh_prediction',
           'create_dls_robot_forward', 'create_dls_robot_forward_prediction', 'create_dls_robot_inverse',
           'create_dls_robot_inverse_prediction', 'create_dls_downl']

# %% ../../nbs/01_datasets/01_external.ipynb 2
from fastai.data.all import *

from ..data import *
from .core import *

from sysbench_loader import *

# %% ../../nbs/01_datasets/01_external.ipynb 3
@delegates(create_dls, keep=True)
def create_dls_downl(
    dataset,#path to the dataset directory
    download_function=None,# function 
    **kwargs
):
    dataset = Path(dataset)

    if not is_dataset_directory(dataset):
        if download_function is not None:
            print(f'Dataset not found. Downloading it to "{dataset}"')
            download_function(dataset)
        else:
            raise ValueError(f'{dataset} does not contain a dataset. Check the path or activate the download flag.')

    return create_dls(dataset=dataset,**kwargs)

# %% ../../nbs/01_datasets/01_external.ipynb 5
u = ['u0']
y = ['y0']
download_function = wiener_hammerstein

create_dls_wh = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
)

create_dls_wh_prediction = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
    prediction=True
)

# %% ../../nbs/01_datasets/01_external.ipynb 8
u = ['u0']
y = ['y0']
download_function = silverbox

create_dls_silverbox = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
)

create_dls_silverbox_prediction = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
    prediction=True
)

# %% ../../nbs/01_datasets/01_external.ipynb 10
u = ['u0']
y = ['y0']
download_function = cascaded_tanks

create_dls_cascaded_tanks = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
)

create_dls_cascaded_tanks_prediction = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
    prediction=True
)

# %% ../../nbs/01_datasets/01_external.ipynb 12
u = ['u0']
y = ['y0']
download_function = emps

create_dls_emps = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
)

create_dls_emps_prediction = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
    prediction=True
)

# %% ../../nbs/01_datasets/01_external.ipynb 14
u = ['u0']
y = ['y0']
download_function = noisy_wh

create_dls_noisy_wh = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
)

create_dls_noisy_wh_prediction = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
    prediction=True
)

# %% ../../nbs/01_datasets/01_external.ipynb 16
u = [f'u{i}' for i in range(6)]
y = [f'y{i}' for i in range(6)]
download_function = robot_forward

create_dls_robot_forward = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
)

create_dls_robot_forward_prediction = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
    prediction=True
)

# %% ../../nbs/01_datasets/01_external.ipynb 18
u = [f'u{i}' for i in range(18)]
y = [f'y{i}' for i in range(6)]
download_function = robot_inverse

create_dls_robot_inverse = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
)

create_dls_robot_inverse_prediction = partial(
    create_dls_downl, 
    download_function=download_function,
    u=u,y=y,
    win_sz=100,
    prediction=True
)
